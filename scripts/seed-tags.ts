/**
 * Seed base tag data (scene/method/taste/crowd/occasion).
 *
 * Run: npx tsx scripts/seed-tags.ts
 */

import { config } from "dotenv";
import { PrismaClient } from "@prisma/client";
import { Pool } from "pg";
import { PrismaPg } from "@prisma/adapter-pg";

config({ path: ".env.local" });

const connectionString = process.env.DATABASE_URL;
if (!connectionString) {
  throw new Error("DATABASE_URL is not set. Please check .env.local file.");
}

const pool = new Pool({ connectionString });
const adapter = new PrismaPg(pool);
const prisma = new PrismaClient({ adapter });

type TagSeed = {
  id: string;
  type: "scene" | "method" | "taste" | "crowd" | "occasion";
  nameZh: string;
  nameEn: string;
  slug: string;
  sortOrder: number;
};

const tags: TagSeed[] = [
  // åœºæ™¯
  {
    id: "scene-01",
    type: "scene",
    nameZh: "æ—©é¤",
    nameEn: "Breakfast",
    slug: "breakfast",
    sortOrder: 1,
  },
  {
    id: "scene-02",
    type: "scene",
    nameZh: "åˆé¤",
    nameEn: "Lunch",
    slug: "lunch",
    sortOrder: 2,
  },
  {
    id: "scene-03",
    type: "scene",
    nameZh: "æ™šé¤",
    nameEn: "Dinner",
    slug: "dinner",
    sortOrder: 3,
  },
  {
    id: "scene-04",
    type: "scene",
    nameZh: "ä¸‹åˆèŒ¶",
    nameEn: "Afternoon Tea",
    slug: "afternoon-tea",
    sortOrder: 4,
  },
  {
    id: "scene-05",
    type: "scene",
    nameZh: "å¤œå®µ",
    nameEn: "Late Night Snack",
    slug: "late-night-snack",
    sortOrder: 5,
  },
  {
    id: "scene-06",
    type: "scene",
    nameZh: "ä¾¿å½“",
    nameEn: "Bento",
    slug: "bento",
    sortOrder: 6,
  },
  {
    id: "scene-07",
    type: "scene",
    nameZh: "å¿«æ‰‹èœ",
    nameEn: "Quick Dish",
    slug: "quick-dish",
    sortOrder: 7,
  },
  {
    id: "scene-08",
    type: "scene",
    nameZh: "æ‡’äººèœ",
    nameEn: "Lazy Cooking",
    slug: "lazy-cooking",
    sortOrder: 8,
  },
  {
    id: "scene-09",
    type: "scene",
    nameZh: "ä¸‹é…’èœ",
    nameEn: "Drinking Snack",
    slug: "drinking-snack",
    sortOrder: 9,
  },
  {
    id: "scene-10",
    type: "scene",
    nameZh: "ä¸‹é¥­èœ",
    nameEn: "Rice Pairing",
    slug: "rice-pairing",
    sortOrder: 10,
  },
  {
    id: "scene-11",
    type: "scene",
    nameZh: "å‡è„‚é¤",
    nameEn: "Weight Loss Meal",
    slug: "weight-loss-meal",
    sortOrder: 11,
  },
  {
    id: "scene-12",
    type: "scene",
    nameZh: "å¥èº«é¤",
    nameEn: "Fitness Meal",
    slug: "fitness-meal",
    sortOrder: 12,
  },
  {
    id: "scene-13",
    type: "scene",
    nameZh: "å„¿ç«¥é¤",
    nameEn: "Kids Meal",
    slug: "kids-meal",
    sortOrder: 13,
  },
  {
    id: "scene-14",
    type: "scene",
    nameZh: "æœˆå­é¤",
    nameEn: "Postpartum Meal",
    slug: "postpartum-meal",
    sortOrder: 14,
  },
  {
    id: "scene-15",
    type: "scene",
    nameZh: "è€äººé¤",
    nameEn: "Senior Meal",
    slug: "senior-meal",
    sortOrder: 15,
  },

  // çƒ¹é¥ªæ–¹æ³•
  {
    id: "method-01",
    type: "method",
    nameZh: "ç‚’",
    nameEn: "Stir-Fry",
    slug: "stir-fry",
    sortOrder: 1,
  },
  {
    id: "method-02",
    type: "method",
    nameZh: "è’¸",
    nameEn: "Steam",
    slug: "steam",
    sortOrder: 2,
  },
  {
    id: "method-03",
    type: "method",
    nameZh: "ç‚–",
    nameEn: "Stew",
    slug: "stew",
    sortOrder: 3,
  },
  {
    id: "method-04",
    type: "method",
    nameZh: "çƒ¤",
    nameEn: "Bake/Roast",
    slug: "bake-roast",
    sortOrder: 4,
  },
  {
    id: "method-05",
    type: "method",
    nameZh: "ç…®",
    nameEn: "Boil",
    slug: "boil",
    sortOrder: 5,
  },
  {
    id: "method-06",
    type: "method",
    nameZh: "ç…Ž",
    nameEn: "Pan-Fry",
    slug: "pan-fry",
    sortOrder: 6,
  },
  {
    id: "method-07",
    type: "method",
    nameZh: "ç‚¸",
    nameEn: "Deep-Fry",
    slug: "deep-fry",
    sortOrder: 7,
  },
  {
    id: "method-08",
    type: "method",
    nameZh: "çƒ§",
    nameEn: "Braise",
    slug: "braise",
    sortOrder: 8,
  },
  {
    id: "method-09",
    type: "method",
    nameZh: "ç„–",
    nameEn: "Simmer",
    slug: "simmer",
    sortOrder: 9,
  },
  {
    id: "method-10",
    type: "method",
    nameZh: "æ‹Œ",
    nameEn: "Toss/Mix",
    slug: "toss-mix",
    sortOrder: 10,
  },
  {
    id: "method-11",
    type: "method",
    nameZh: "å¤",
    nameEn: "Braise in Soy Sauce",
    slug: "braise-in-soy-sauce",
    sortOrder: 11,
  },
  {
    id: "method-12",
    type: "method",
    nameZh: "ç…²",
    nameEn: "Soup Pot",
    slug: "soup-pot",
    sortOrder: 12,
  },
  {
    id: "method-13",
    type: "method",
    nameZh: "ç‚",
    nameEn: "Quick-Fry",
    slug: "quick-fry",
    sortOrder: 13,
  },
  {
    id: "method-14",
    type: "method",
    nameZh: "è…Œ",
    nameEn: "Pickle/Marinate",
    slug: "pickle-marinate",
    sortOrder: 14,
  },
  {
    id: "method-15",
    type: "method",
    nameZh: "ç†",
    nameEn: "Smoke",
    slug: "smoke",
    sortOrder: 15,
  },
  {
    id: "method-16",
    type: "method",
    nameZh: "å‡‰æ‹Œ",
    nameEn: "Cold Dish",
    slug: "cold-dish",
    sortOrder: 16,
  },
  {
    id: "method-17",
    type: "method",
    nameZh: "çƒ™",
    nameEn: "Griddle",
    slug: "griddle",
    sortOrder: 17,
  },
  {
    id: "method-18",
    type: "method",
    nameZh: "æ‰’",
    nameEn: "SautÃ©",
    slug: "saute",
    sortOrder: 18,
  },
  {
    id: "method-19",
    type: "method",
    nameZh: "çˆ†",
    nameEn: "Quick-Blast",
    slug: "quick-blast",
    sortOrder: 19,
  },
  {
    id: "method-20",
    type: "method",
    nameZh: "é†‰",
    nameEn: "Wine-Soaked",
    slug: "wine-soaked",
    sortOrder: 20,
  },

  // å£å‘³
  {
    id: "flavor-01",
    type: "taste",
    nameZh: "å’¸é¦™",
    nameEn: "Savory",
    slug: "savory",
    sortOrder: 1,
  },
  {
    id: "flavor-02",
    type: "taste",
    nameZh: "éº»è¾£",
    nameEn: "Spicy",
    slug: "spicy",
    sortOrder: 2,
  },
  {
    id: "flavor-03",
    type: "taste",
    nameZh: "é¦™è¾£",
    nameEn: "Hot & Spicy",
    slug: "hot-spicy",
    sortOrder: 3,
  },
  {
    id: "flavor-04",
    type: "taste",
    nameZh: "é…¸è¾£",
    nameEn: "Sour & Spicy",
    slug: "sour-spicy",
    sortOrder: 4,
  },
  {
    id: "flavor-05",
    type: "taste",
    nameZh: "ç³–é†‹",
    nameEn: "Sweet & Sour",
    slug: "sweet-sour",
    sortOrder: 5,
  },
  {
    id: "flavor-06",
    type: "taste",
    nameZh: "æ¸…æ·¡",
    nameEn: "Light",
    slug: "light",
    sortOrder: 6,
  },
  {
    id: "flavor-07",
    type: "taste",
    nameZh: "é²œé¦™",
    nameEn: "Umami",
    slug: "umami",
    sortOrder: 7,
  },
  {
    id: "flavor-08",
    type: "taste",
    nameZh: "ç”œå‘³",
    nameEn: "Sweet",
    slug: "sweet",
    sortOrder: 8,
  },
  {
    id: "flavor-09",
    type: "taste",
    nameZh: "å’¸é²œ",
    nameEn: "Salty & Fresh",
    slug: "salty-fresh",
    sortOrder: 9,
  },
  {
    id: "flavor-10",
    type: "taste",
    nameZh: "é…±é¦™",
    nameEn: "Sauce Flavor",
    slug: "sauce-flavor",
    sortOrder: 10,
  },
  {
    id: "flavor-11",
    type: "taste",
    nameZh: "è’œé¦™",
    nameEn: "Garlic Flavor",
    slug: "garlic-flavor",
    sortOrder: 11,
  },
  {
    id: "flavor-12",
    type: "taste",
    nameZh: "æ¤’ç›",
    nameEn: "Salt & Pepper",
    slug: "salt-pepper",
    sortOrder: 12,
  },
  {
    id: "flavor-13",
    type: "taste",
    nameZh: "å­œç„¶",
    nameEn: "Cumin",
    slug: "cumin",
    sortOrder: 13,
  },
  {
    id: "flavor-14",
    type: "taste",
    nameZh: "äº”é¦™",
    nameEn: "Five-Spice",
    slug: "five-spice",
    sortOrder: 14,
  },
  {
    id: "flavor-15",
    type: "taste",
    nameZh: "è‘±é¦™",
    nameEn: "Scallion Flavor",
    slug: "scallion-flavor",
    sortOrder: 15,
  },
  {
    id: "flavor-16",
    type: "taste",
    nameZh: "å§œå‘³",
    nameEn: "Ginger Flavor",
    slug: "ginger-flavor",
    sortOrder: 16,
  },
  {
    id: "flavor-17",
    type: "taste",
    nameZh: "é…’é¦™",
    nameEn: "Wine Aroma",
    slug: "wine-aroma",
    sortOrder: 17,
  },
  {
    id: "flavor-18",
    type: "taste",
    nameZh: "èŒ¶é¦™",
    nameEn: "Tea Flavor",
    slug: "tea-flavor",
    sortOrder: 18,
  },
  {
    id: "flavor-19",
    type: "taste",
    nameZh: "çƒŸç†",
    nameEn: "Smoky",
    slug: "smoky",
    sortOrder: 19,
  },
  {
    id: "flavor-20",
    type: "taste",
    nameZh: "æ¸…çˆ½",
    nameEn: "Refreshing",
    slug: "refreshing",
    sortOrder: 20,
  },

  // é€‚å®œäººç¾¤
  {
    id: "suitable-01",
    type: "crowd",
    nameZh: "å­•å¦‡",
    nameEn: "Pregnant Women",
    slug: "pregnant-women",
    sortOrder: 1,
  },
  {
    id: "suitable-02",
    type: "crowd",
    nameZh: "äº§å¦‡",
    nameEn: "Postpartum Women",
    slug: "postpartum-women",
    sortOrder: 2,
  },
  {
    id: "suitable-03",
    type: "crowd",
    nameZh: "å„¿ç«¥",
    nameEn: "Children",
    slug: "children",
    sortOrder: 3,
  },
  {
    id: "suitable-04",
    type: "crowd",
    nameZh: "è€äºº",
    nameEn: "Seniors",
    slug: "seniors",
    sortOrder: 4,
  },
  {
    id: "suitable-05",
    type: "crowd",
    nameZh: "ç³–å°¿ç—…",
    nameEn: "Diabetes",
    slug: "diabetes",
    sortOrder: 5,
  },
  {
    id: "suitable-06",
    type: "crowd",
    nameZh: "é«˜è¡€åŽ‹",
    nameEn: "Hypertension",
    slug: "hypertension",
    sortOrder: 6,
  },
  {
    id: "suitable-07",
    type: "crowd",
    nameZh: "è´«è¡€",
    nameEn: "Anemia",
    slug: "anemia",
    sortOrder: 7,
  },
  {
    id: "suitable-08",
    type: "crowd",
    nameZh: "ç—›é£Ž",
    nameEn: "Gout",
    slug: "gout",
    sortOrder: 8,
  },
  {
    id: "suitable-09",
    type: "crowd",
    nameZh: "è‚ èƒƒä¸å¥½",
    nameEn: "Digestive Issues",
    slug: "digestive-issues",
    sortOrder: 9,
  },
  {
    id: "suitable-10",
    type: "crowd",
    nameZh: "ä¾¿ç§˜",
    nameEn: "Constipation",
    slug: "constipation",
    sortOrder: 10,
  },
  {
    id: "suitable-11",
    type: "crowd",
    nameZh: "å‡è‚¥äººç¾¤",
    nameEn: "Weight Loss",
    slug: "weight-loss",
    sortOrder: 11,
  },
  {
    id: "suitable-12",
    type: "crowd",
    nameZh: "å¥èº«äººç¾¤",
    nameEn: "Fitness",
    slug: "fitness",
    sortOrder: 12,
  },
  {
    id: "suitable-13",
    type: "crowd",
    nameZh: "ä¸Šç­æ—",
    nameEn: "Office Workers",
    slug: "office-workers",
    sortOrder: 13,
  },
  {
    id: "suitable-14",
    type: "crowd",
    nameZh: "å­¦ç”Ÿ",
    nameEn: "Students",
    slug: "students",
    sortOrder: 14,
  },
  {
    id: "suitable-15",
    type: "crowd",
    nameZh: "ç´ é£Ÿè€…",
    nameEn: "Vegetarians",
    slug: "vegetarians",
    sortOrder: 15,
  },
  {
    id: "suitable-16",
    type: "crowd",
    nameZh: "è¿‡æ•ä½“è´¨",
    nameEn: "Allergies",
    slug: "allergies",
    sortOrder: 16,
  },
  {
    id: "suitable-17",
    type: "crowd",
    nameZh: "è‚¾ç—…",
    nameEn: "Kidney Disease",
    slug: "kidney-disease",
    sortOrder: 17,
  },
  {
    id: "suitable-18",
    type: "crowd",
    nameZh: "è„‚è‚ªè‚",
    nameEn: "Fatty Liver",
    slug: "fatty-liver",
    sortOrder: 18,
  },
  {
    id: "suitable-19",
    type: "crowd",
    nameZh: "æ„Ÿå†’å’³å—½",
    nameEn: "Cold & Cough",
    slug: "cold-cough",
    sortOrder: 19,
  },
  {
    id: "suitable-20",
    type: "crowd",
    nameZh: "ç†¬å¤œäººç¾¤",
    nameEn: "Night Owls",
    slug: "night-owls",
    sortOrder: 20,
  },

  // åœºåˆ
  {
    id: "occasion-01",
    type: "occasion",
    nameZh: "å®¶å¸¸èœ",
    nameEn: "Home Cooking",
    slug: "home-cooking",
    sortOrder: 1,
  },
  {
    id: "occasion-02",
    type: "occasion",
    nameZh: "å®´å®¢èœ",
    nameEn: "Banquet Dish",
    slug: "banquet-dish",
    sortOrder: 2,
  },
  {
    id: "occasion-03",
    type: "occasion",
    nameZh: "æ˜¥èŠ‚",
    nameEn: "Chinese New Year",
    slug: "chinese-new-year",
    sortOrder: 3,
  },
  {
    id: "occasion-04",
    type: "occasion",
    nameZh: "ä¸­ç§‹èŠ‚",
    nameEn: "Mid-Autumn Festival",
    slug: "mid-autumn-festival",
    sortOrder: 4,
  },
  {
    id: "occasion-05",
    type: "occasion",
    nameZh: "ç«¯åˆèŠ‚",
    nameEn: "Dragon Boat Festival",
    slug: "dragon-boat-festival",
    sortOrder: 5,
  },
  {
    id: "occasion-06",
    type: "occasion",
    nameZh: "å…ƒå®µèŠ‚",
    nameEn: "Lantern Festival",
    slug: "lantern-festival",
    sortOrder: 6,
  },
  {
    id: "occasion-07",
    type: "occasion",
    nameZh: "æ¸…æ˜ŽèŠ‚",
    nameEn: "Qingming Festival",
    slug: "qingming-festival",
    sortOrder: 7,
  },
  {
    id: "occasion-08",
    type: "occasion",
    nameZh: "é‡é˜³èŠ‚",
    nameEn: "Double Ninth Festival",
    slug: "double-ninth-festival",
    sortOrder: 8,
  },
  {
    id: "occasion-09",
    type: "occasion",
    nameZh: "ç”Ÿæ—¥å®´",
    nameEn: "Birthday Party",
    slug: "birthday-party",
    sortOrder: 9,
  },
  {
    id: "occasion-10",
    type: "occasion",
    nameZh: "å©šå®´",
    nameEn: "Wedding Banquet",
    slug: "wedding-banquet",
    sortOrder: 10,
  },
  {
    id: "occasion-11",
    type: "occasion",
    nameZh: "æ»¡æœˆé…’",
    nameEn: "Full Month Celebration",
    slug: "full-month-celebration",
    sortOrder: 11,
  },
  {
    id: "occasion-12",
    type: "occasion",
    nameZh: "èšé¤",
    nameEn: "Gathering",
    slug: "gathering",
    sortOrder: 12,
  },
  {
    id: "occasion-13",
    type: "occasion",
    nameZh: "é‡Žé¤",
    nameEn: "Picnic",
    slug: "picnic",
    sortOrder: 13,
  },
  {
    id: "occasion-14",
    type: "occasion",
    nameZh: "çƒ§çƒ¤",
    nameEn: "BBQ",
    slug: "bbq",
    sortOrder: 14,
  },
  {
    id: "occasion-15",
    type: "occasion",
    nameZh: "ç«é”…",
    nameEn: "Hot Pot",
    slug: "hot-pot",
    sortOrder: 15,
  },
  {
    id: "occasion-16",
    type: "occasion",
    nameZh: "ä¸‹åˆèŒ¶",
    nameEn: "Afternoon Tea",
    slug: "afternoon-tea-occasion",
    sortOrder: 16,
  },
  {
    id: "occasion-17",
    type: "occasion",
    nameZh: "çœ‹çƒèµ›",
    nameEn: "Watch Sports",
    slug: "watch-sports",
    sortOrder: 17,
  },
  {
    id: "occasion-18",
    type: "occasion",
    nameZh: "è¿½å‰§",
    nameEn: "Binge-Watching",
    slug: "binge-watching",
    sortOrder: 18,
  },
  {
    id: "occasion-19",
    type: "occasion",
    nameZh: "å‘¨æœ«",
    nameEn: "Weekend",
    slug: "weekend",
    sortOrder: 19,
  },
  {
    id: "occasion-20",
    type: "occasion",
    nameZh: "çºªå¿µæ—¥",
    nameEn: "Anniversary",
    slug: "anniversary",
    sortOrder: 20,
  },
];

async function main() {
  console.log(`ðŸŒ± å¼€å§‹å¯¼å…¥æ ‡ç­¾æ•°æ®ï¼Œå…± ${tags.length} æ¡...`);

  for (const tag of tags) {
    const record = await prisma.tag.upsert({
      where: { slug: tag.slug },
      create: {
        id: tag.id,
        type: tag.type,
        name: tag.nameZh,
        slug: tag.slug,
        sortOrder: tag.sortOrder,
        isActive: true,
      },
      update: {
        type: tag.type,
        name: tag.nameZh,
        sortOrder: tag.sortOrder,
        isActive: true,
      },
    });

    await prisma.tagTranslation.upsert({
      where: {
        tagId_locale: {
          tagId: record.id,
          locale: "en",
        },
      },
      create: {
        tagId: record.id,
        locale: "en",
        name: tag.nameEn,
        slug: tag.slug,
      },
      update: {
        name: tag.nameEn,
        slug: tag.slug,
      },
    });
  }

  console.log("âœ… æ ‡ç­¾æ•°æ®å¯¼å…¥å®Œæˆ");
}

main()
  .catch((error) => {
    console.error("âŒ å¯¼å…¥å¤±è´¥:", error);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
    await pool.end();
  });
